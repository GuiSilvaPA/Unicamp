{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"name":"Aula 9 - Guilherme Pereira","provenance":[{"file_id":"1zOcG-C5Iq3KzDlgWnR65WrDb1o3r9zgd","timestamp":1653883575739},{"file_id":"1thx-vdS1n8vR1HtveXocssSqXow3IILx","timestamp":1653495618465},{"file_id":"1oUPmBvoWiXCIpXwsAQT-DlRy4Ii5_h42","timestamp":1652647096817},{"file_id":"1xCdpeOnZFsAYdmRBsPhgUpP591VwnGrV","timestamp":1651949635838},{"file_id":"1pnYddT2lh5JuZv30O3Ra7AoDJq5_RgCT","timestamp":1584998737795}],"collapsed_sections":[]},"kernelspec":{"name":"python3","display_name":"Python 3"},"accelerator":"GPU","widgets":{"application/vnd.jupyter.widget-state+json":{"fa5b9ad9107f4495af162ca7d7e63586":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_df40bc6e66134a15a2ab0e34e77be126","IPY_MODEL_593b2018cb4d4a7f90cecdb149713aaf","IPY_MODEL_e38af0ba41144e0b931cd1c953f892d3"],"layout":"IPY_MODEL_3b41eb3b282b4a9d824bc9233fae5fa4"}},"df40bc6e66134a15a2ab0e34e77be126":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_cb67a69ca3ff4f49bb0b91f312c9a98b","placeholder":"​","style":"IPY_MODEL_fb544bf051fc4df5931c65bb00b890ef","value":"100%"}},"593b2018cb4d4a7f90cecdb149713aaf":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_0ef9272373224752a92f6af2c247e3fe","max":2,"min":0,"orientation":"horizontal","style":"IPY_MODEL_fcdde59edbaa4005932060ec7d33b03a","value":2}},"e38af0ba41144e0b931cd1c953f892d3":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_0984a3e279df4803a93c03e09cf8fdca","placeholder":"​","style":"IPY_MODEL_8fb2b502b5774b9ea7984374638e879f","value":" 2/2 [00:00&lt;00:00, 60.74it/s]"}},"3b41eb3b282b4a9d824bc9233fae5fa4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"cb67a69ca3ff4f49bb0b91f312c9a98b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"fb544bf051fc4df5931c65bb00b890ef":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"0ef9272373224752a92f6af2c247e3fe":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"fcdde59edbaa4005932060ec7d33b03a":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"0984a3e279df4803a93c03e09cf8fdca":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8fb2b502b5774b9ea7984374638e879f":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"8716f4567f6e432b8880e15f2b1837bb":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_9a76a4043a944c74b6b7f936f0a95a86","IPY_MODEL_0815d6d4b6064013ae2fce438b25e923","IPY_MODEL_da33629749d4405f8f617a9ae4bf95e9"],"layout":"IPY_MODEL_ebbd026fa1004fadb82df4ee644f5e55"}},"9a76a4043a944c74b6b7f936f0a95a86":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_2c7ce3e3726c447a9bce49f65fd63149","placeholder":"​","style":"IPY_MODEL_ceebfca223334c34b73fdbacaca4b738","value":"100%"}},"0815d6d4b6064013ae2fce438b25e923":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_d985cd388c0f4ec1aa3042447339323f","max":80000,"min":0,"orientation":"horizontal","style":"IPY_MODEL_e3f660e8b4614738b0212bcde2153865","value":80000}},"da33629749d4405f8f617a9ae4bf95e9":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_c9925116555b41f5b280df76b5cd3f4d","placeholder":"​","style":"IPY_MODEL_fb424a91c74a414eafd82960cf374867","value":" 80000/80000 [00:15&lt;00:00, 5160.04it/s]"}},"ebbd026fa1004fadb82df4ee644f5e55":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2c7ce3e3726c447a9bce49f65fd63149":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ceebfca223334c34b73fdbacaca4b738":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"d985cd388c0f4ec1aa3042447339323f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e3f660e8b4614738b0212bcde2153865":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"c9925116555b41f5b280df76b5cd3f4d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"fb424a91c74a414eafd82960cf374867":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"f081061b3ff7456aa3e0224697d851b3":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_edc61319813d431aa96f662bd4452527","IPY_MODEL_636be7aed451463b9a63bf11b0b5fccf","IPY_MODEL_d1cad6273c304a5ba8015093606a2f36"],"layout":"IPY_MODEL_7dadfd5e2cd6412cac22c1c3783c6a37"}},"edc61319813d431aa96f662bd4452527":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_9c7e2d9e55c241e4aacbb9e83ffb8b01","placeholder":"​","style":"IPY_MODEL_7a290a7fef7a478595465b6ab82a5ce1","value":"100%"}},"636be7aed451463b9a63bf11b0b5fccf":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_94dfb33d6e5b4b33bb0e6fabfef99cbe","max":80000,"min":0,"orientation":"horizontal","style":"IPY_MODEL_3c6d38593bae473f96451727200183c5","value":80000}},"d1cad6273c304a5ba8015093606a2f36":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_5b948c7be4be40b2b9c4a779a6ebbd55","placeholder":"​","style":"IPY_MODEL_a842ff0bb4c7407cbbc2f23ec21417be","value":" 80000/80000 [00:00&lt;00:00, 308305.01it/s]"}},"7dadfd5e2cd6412cac22c1c3783c6a37":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9c7e2d9e55c241e4aacbb9e83ffb8b01":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"7a290a7fef7a478595465b6ab82a5ce1":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"94dfb33d6e5b4b33bb0e6fabfef99cbe":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3c6d38593bae473f96451727200183c5":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"5b948c7be4be40b2b9c4a779a6ebbd55":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a842ff0bb4c7407cbbc2f23ec21417be":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"26dbf97ce333461396ce99b536601206":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_dcd51083a535415b97e6ee4965c90a95","IPY_MODEL_a448526b03bf4ed29920ad113cbfbef1","IPY_MODEL_1dae9b9d192a447991a72adbf0aef288"],"layout":"IPY_MODEL_e53ac2d555154ee99451fe5ce66a7f5e"}},"dcd51083a535415b97e6ee4965c90a95":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_d13c727d0b2046b9be246bac0a610318","placeholder":"​","style":"IPY_MODEL_d84838b921d8474a8e467413e97cfd02","value":"100%"}},"a448526b03bf4ed29920ad113cbfbef1":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_281ace48e036437d9b9a29e66e6773b1","max":20000,"min":0,"orientation":"horizontal","style":"IPY_MODEL_494d88606b384b388672ed64afe820b6","value":20000}},"1dae9b9d192a447991a72adbf0aef288":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_7cedf8a318d14d5c989aac7e6a8fe43e","placeholder":"​","style":"IPY_MODEL_02eaaf2dccc14595a942263e987ba532","value":" 20000/20000 [00:03&lt;00:00, 5105.89it/s]"}},"e53ac2d555154ee99451fe5ce66a7f5e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d13c727d0b2046b9be246bac0a610318":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d84838b921d8474a8e467413e97cfd02":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"281ace48e036437d9b9a29e66e6773b1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"494d88606b384b388672ed64afe820b6":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"7cedf8a318d14d5c989aac7e6a8fe43e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"02eaaf2dccc14595a942263e987ba532":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"b2c8a7195fd24b20b778d3708b9fbc33":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_237117659d0847d7a694f7f029a2964e","IPY_MODEL_ea605fef683c409ba8352b665f002e20","IPY_MODEL_3df9e6b3ba99412996199278078a8de9"],"layout":"IPY_MODEL_5ddc7eebe19b4f08b180795a5fb653a1"}},"237117659d0847d7a694f7f029a2964e":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_0ed7830970d14ee6bf094ccf75b05a3a","placeholder":"​","style":"IPY_MODEL_5450fe0cb9d645d6be6e29be7bd4d08e","value":"100%"}},"ea605fef683c409ba8352b665f002e20":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_fa4dbbdcbeb64e5ab5a9239ad01ec075","max":20000,"min":0,"orientation":"horizontal","style":"IPY_MODEL_73b51f202cb041d2b45ec2578e524daa","value":20000}},"3df9e6b3ba99412996199278078a8de9":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_c1bcb33e87a94e6aa7d4946e73614c2e","placeholder":"​","style":"IPY_MODEL_e85111dda09d4edfad066a3326037bb9","value":" 20000/20000 [00:00&lt;00:00, 252085.02it/s]"}},"5ddc7eebe19b4f08b180795a5fb653a1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0ed7830970d14ee6bf094ccf75b05a3a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5450fe0cb9d645d6be6e29be7bd4d08e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"fa4dbbdcbeb64e5ab5a9239ad01ec075":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"73b51f202cb041d2b45ec2578e524daa":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"c1bcb33e87a94e6aa7d4946e73614c2e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e85111dda09d4edfad066a3326037bb9":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"28137371170a49bd9b32ac27f5ff6bd2":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_dee3f2678078408f8008868c2db693e8","IPY_MODEL_ecfc59ddaaf445b7834561e2b5f51aeb","IPY_MODEL_2fcad1a5abaa415abef77390048fa832"],"layout":"IPY_MODEL_f40acfce117f48d1a906f727bfc4ef6e"}},"dee3f2678078408f8008868c2db693e8":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_717dba7d89564c3d893989c93f49fcb5","placeholder":"​","style":"IPY_MODEL_dc2a906e30284649937d325d16560422","value":"100%"}},"ecfc59ddaaf445b7834561e2b5f51aeb":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_4f1a41890e5b42beb65b254d9d14794d","max":20000,"min":0,"orientation":"horizontal","style":"IPY_MODEL_4d26dbb71e5e4774bb49f1ce201d52ee","value":20000}},"2fcad1a5abaa415abef77390048fa832":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_92894d7546304a79b5f5292247d24686","placeholder":"​","style":"IPY_MODEL_f6665491d2e045eeb74fe835400786d4","value":" 20000/20000 [00:03&lt;00:00, 5143.64it/s]"}},"f40acfce117f48d1a906f727bfc4ef6e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"717dba7d89564c3d893989c93f49fcb5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"dc2a906e30284649937d325d16560422":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"4f1a41890e5b42beb65b254d9d14794d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4d26dbb71e5e4774bb49f1ce201d52ee":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"92894d7546304a79b5f5292247d24686":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f6665491d2e045eeb74fe835400786d4":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"4b8260675d654bdd88ccb9fd9492f715":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_fbd295484c0b4a2682fa30d3e7bd5c7f","IPY_MODEL_f45c7c33bc6b489db7bbc72b83ada377","IPY_MODEL_ddf365c3c129436b836129c2a7175864"],"layout":"IPY_MODEL_71944128ccb84fbe9ffeb1b3d396bb29"}},"fbd295484c0b4a2682fa30d3e7bd5c7f":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_44905b79a7f44e43974d4b51b9a49cb5","placeholder":"​","style":"IPY_MODEL_2859d469daa74101ab1256885a02d26e","value":"100%"}},"f45c7c33bc6b489db7bbc72b83ada377":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_1c9e4233bbef48d4b355cf81fcc2f654","max":20000,"min":0,"orientation":"horizontal","style":"IPY_MODEL_09c40e17253446ff9917ac39cd41ba64","value":20000}},"ddf365c3c129436b836129c2a7175864":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_f9bc1023f4e0434e9a48e3bf595a2e8c","placeholder":"​","style":"IPY_MODEL_ded65016c1bf429fa0290bb80edb0ec0","value":" 20000/20000 [00:00&lt;00:00, 249773.95it/s]"}},"71944128ccb84fbe9ffeb1b3d396bb29":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"44905b79a7f44e43974d4b51b9a49cb5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2859d469daa74101ab1256885a02d26e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"1c9e4233bbef48d4b355cf81fcc2f654":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"09c40e17253446ff9917ac39cd41ba64":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"f9bc1023f4e0434e9a48e3bf595a2e8c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ded65016c1bf429fa0290bb80edb0ec0":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"12b314f16e574aed9c2bc27aa6801c57":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_ef376f01d0ce4a4c999ff41693863256","IPY_MODEL_a3296ab23cac4882b444b7cb64efb69a","IPY_MODEL_41764de7c03f4852bdf129ceecd1b7e8"],"layout":"IPY_MODEL_9b88ed1c3602467a8e0cb3074f9b8daa"}},"ef376f01d0ce4a4c999ff41693863256":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_06df1a7218914fea8dfac586e489bf4b","placeholder":"​","style":"IPY_MODEL_ef0362c9812f4ecfa6137478bac53e75","value":"100%"}},"a3296ab23cac4882b444b7cb64efb69a":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_34b82ca831c4402f9b374a5b7003f328","max":500000,"min":0,"orientation":"horizontal","style":"IPY_MODEL_5936d768eccb4d96b7f937f156fa40a9","value":500000}},"41764de7c03f4852bdf129ceecd1b7e8":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_3b41a80a2b0645acb30d15b90d9234a2","placeholder":"​","style":"IPY_MODEL_e1d158e7adfe4b0781577e0245f1d877","value":" 500000/500000 [01:58&lt;00:00, 4251.74it/s]"}},"9b88ed1c3602467a8e0cb3074f9b8daa":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"06df1a7218914fea8dfac586e489bf4b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ef0362c9812f4ecfa6137478bac53e75":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"34b82ca831c4402f9b374a5b7003f328":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5936d768eccb4d96b7f937f156fa40a9":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"3b41a80a2b0645acb30d15b90d9234a2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e1d158e7adfe4b0781577e0245f1d877":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"fcbde028a7de461c84744d98d7faa304":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_ec281a7514de49e191059dc1345c090d","IPY_MODEL_e50013af3bf9497692c4a8e3d3c121a9","IPY_MODEL_34c69a43eb57428e83058f1ef1f8b287"],"layout":"IPY_MODEL_66a1d7a106d34594a96c3eed52cf612d"}},"ec281a7514de49e191059dc1345c090d":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_6281b28623744de0af1b053fb5336cc6","placeholder":"​","style":"IPY_MODEL_8367659b8bc24f27b7147235bbe7390f","value":"100%"}},"e50013af3bf9497692c4a8e3d3c121a9":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_d5d36125e822403b8a1a9528cd959f3f","max":500000,"min":0,"orientation":"horizontal","style":"IPY_MODEL_71f717cd6f524160a8003a1fa368fc4e","value":500000}},"34c69a43eb57428e83058f1ef1f8b287":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_010d76f0973041088ad186ead797956c","placeholder":"​","style":"IPY_MODEL_8841838191dc4072999ea04dbd5d1997","value":" 500000/500000 [01:42&lt;00:00, 5140.26it/s]"}},"66a1d7a106d34594a96c3eed52cf612d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6281b28623744de0af1b053fb5336cc6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8367659b8bc24f27b7147235bbe7390f":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"d5d36125e822403b8a1a9528cd959f3f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"71f717cd6f524160a8003a1fa368fc4e":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"010d76f0973041088ad186ead797956c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8841838191dc4072999ea04dbd5d1997":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"81344ee736f14ecb91d36bc9d40c9f94":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_eeed1d6e1979427d966c50c99f554709","IPY_MODEL_5df7a2401266439480c6e1c49c30d9f9","IPY_MODEL_9a7fb12fd79b43ba8b259a5b3c7b929b"],"layout":"IPY_MODEL_8aaa37edc0ff4a50b7a05e445475f9c4"}},"eeed1d6e1979427d966c50c99f554709":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_3a04f6e27b6d418698d3def01d1333f6","placeholder":"​","style":"IPY_MODEL_824086478d6a4de395c2f44354972235","value":"Downloading: 100%"}},"5df7a2401266439480c6e1c49c30d9f9":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_e9a8937c80994c018cc583ffa90abb39","max":209528,"min":0,"orientation":"horizontal","style":"IPY_MODEL_361898c037214344a0e16599b994a9f7","value":209528}},"9a7fb12fd79b43ba8b259a5b3c7b929b":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_580c3eb7b2ce49b0a2725a84113a1499","placeholder":"​","style":"IPY_MODEL_52994510c24c4b37b6e1ae93cffebd36","value":" 205k/205k [00:00&lt;00:00, 258kB/s]"}},"8aaa37edc0ff4a50b7a05e445475f9c4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3a04f6e27b6d418698d3def01d1333f6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"824086478d6a4de395c2f44354972235":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"e9a8937c80994c018cc583ffa90abb39":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"361898c037214344a0e16599b994a9f7":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"580c3eb7b2ce49b0a2725a84113a1499":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"52994510c24c4b37b6e1ae93cffebd36":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"5fcd502bcd224abd8d55c2f4b9d407fc":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_d82165ba79af4e989ff93fbfc3909d31","IPY_MODEL_4bded2a295f44dd28b77f4208e8c4c04","IPY_MODEL_d243f79a52204c3b8b45063e67bcd3e1"],"layout":"IPY_MODEL_9a65c7d50e764f199cd998b12f404197"}},"d82165ba79af4e989ff93fbfc3909d31":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_c357376ac4cc4ae08a0904ba899a9420","placeholder":"​","style":"IPY_MODEL_5505b8ed41ee40068065895a5b05fcf3","value":"Downloading: 100%"}},"4bded2a295f44dd28b77f4208e8c4c04":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_38f4ca1c8cec4265a08b15cbb0752a37","max":2,"min":0,"orientation":"horizontal","style":"IPY_MODEL_62b009774fc74ec1af3814fce6507861","value":2}},"d243f79a52204c3b8b45063e67bcd3e1":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_ee6e285a31d1457b98c61e06548408c8","placeholder":"​","style":"IPY_MODEL_4c8579cf02b045858897afeba72b7b0c","value":" 2.00/2.00 [00:00&lt;00:00, 61.7B/s]"}},"9a65c7d50e764f199cd998b12f404197":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c357376ac4cc4ae08a0904ba899a9420":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5505b8ed41ee40068065895a5b05fcf3":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"38f4ca1c8cec4265a08b15cbb0752a37":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"62b009774fc74ec1af3814fce6507861":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"ee6e285a31d1457b98c61e06548408c8":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4c8579cf02b045858897afeba72b7b0c":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"0c6f97ef59ab428fa87eb778b22a157d":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_e06b0d9e2f3e443d995aef00e3c72135","IPY_MODEL_af310706b36a4d42b63caa833a08b929","IPY_MODEL_6ea1cff10b794d4aa27627d5de2c3abe"],"layout":"IPY_MODEL_218cec81a229474e9cf6f0147d716684"}},"e06b0d9e2f3e443d995aef00e3c72135":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_689c6dfcee9d4872a1f84e3b8f4c2705","placeholder":"​","style":"IPY_MODEL_c59d7230dc8b4364a5f57c975962a434","value":"Downloading: 100%"}},"af310706b36a4d42b63caa833a08b929":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_abd069aaf6ad44b7b388124e960e5253","max":112,"min":0,"orientation":"horizontal","style":"IPY_MODEL_52a43f7ff4034f368d56dbd4706679a4","value":112}},"6ea1cff10b794d4aa27627d5de2c3abe":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_3d5f1a14363b4a89ad52158a775d8c3f","placeholder":"​","style":"IPY_MODEL_5bdb0c9dd2884041a0b7fc4e81665eb0","value":" 112/112 [00:00&lt;00:00, 3.17kB/s]"}},"218cec81a229474e9cf6f0147d716684":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"689c6dfcee9d4872a1f84e3b8f4c2705":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c59d7230dc8b4364a5f57c975962a434":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"abd069aaf6ad44b7b388124e960e5253":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"52a43f7ff4034f368d56dbd4706679a4":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"3d5f1a14363b4a89ad52158a775d8c3f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5bdb0c9dd2884041a0b7fc4e81665eb0":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"f15add4af0cf4a849e50d670d12335a0":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_dcc87114eea043aebbaa5fe55b0e441e","IPY_MODEL_863bb20541ff41758b052314782715a0","IPY_MODEL_3a591c7465bb423aac0c99a10cc2442a"],"layout":"IPY_MODEL_353e72192b5b482eaa0a6d43cd1e5fb1"}},"dcc87114eea043aebbaa5fe55b0e441e":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_7bcdd789f5c14e9abbc4ee09eaf71d1a","placeholder":"​","style":"IPY_MODEL_03c1e6da37c54c99b3e892aa48ac5cac","value":"Downloading: 100%"}},"863bb20541ff41758b052314782715a0":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_38f3910038484ce088b32840af2a0662","max":43,"min":0,"orientation":"horizontal","style":"IPY_MODEL_f65540f5614b4822a8aa4b11ab96045f","value":43}},"3a591c7465bb423aac0c99a10cc2442a":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_eb2d858642d94bdfaa664d95218c7f34","placeholder":"​","style":"IPY_MODEL_963d0aac754b4cbdb88d636b0ffbe248","value":" 43.0/43.0 [00:00&lt;00:00, 1.26kB/s]"}},"353e72192b5b482eaa0a6d43cd1e5fb1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"7bcdd789f5c14e9abbc4ee09eaf71d1a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"03c1e6da37c54c99b3e892aa48ac5cac":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"38f3910038484ce088b32840af2a0662":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f65540f5614b4822a8aa4b11ab96045f":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"eb2d858642d94bdfaa664d95218c7f34":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"963d0aac754b4cbdb88d636b0ffbe248":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"43207aa140874f3babe22ccb505bed8b":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_2a8fabd22e7a421e8664aab3462d1edb","IPY_MODEL_4f93e4f0b4114668b72bf0a7455ec623","IPY_MODEL_ab281334493c4709b95fb441c4c714e8"],"layout":"IPY_MODEL_f8d5ae79738a4733b2be8608b5ac8dc9"}},"2a8fabd22e7a421e8664aab3462d1edb":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_05d0f483cbf84ee181009079ebe07976","placeholder":"​","style":"IPY_MODEL_f9f7e63559c942fb8bf85f93ad35d53a","value":"Downloading: 100%"}},"4f93e4f0b4114668b72bf0a7455ec623":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_6fe6f20e63584b7cb2022f0c054b2fc9","max":647,"min":0,"orientation":"horizontal","style":"IPY_MODEL_21b535e52b1f48298fc08e758cee8cde","value":647}},"ab281334493c4709b95fb441c4c714e8":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_a053d204092b4a249b56da3d56bc6dd1","placeholder":"​","style":"IPY_MODEL_f034e2d5ac1f4cb899d8bec905389cb6","value":" 647/647 [00:00&lt;00:00, 20.1kB/s]"}},"f8d5ae79738a4733b2be8608b5ac8dc9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"05d0f483cbf84ee181009079ebe07976":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f9f7e63559c942fb8bf85f93ad35d53a":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"6fe6f20e63584b7cb2022f0c054b2fc9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"21b535e52b1f48298fc08e758cee8cde":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"a053d204092b4a249b56da3d56bc6dd1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f034e2d5ac1f4cb899d8bec905389cb6":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"3781f0730c644b678fd8c170f0c81850":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_672f5486ed844fc383c531526bd2ca22","IPY_MODEL_ebc83bd7d9bf44c4944bd11045ad5e83","IPY_MODEL_6f84cbb33d4e48b6acfcd1d9f3da9779"],"layout":"IPY_MODEL_2ae61d0497354d46b5ad25c79a743f1c"}},"672f5486ed844fc383c531526bd2ca22":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_a2976462f9cf423a953c9f1024bb7697","placeholder":"​","style":"IPY_MODEL_63e5da5683e7415fa55a74bebb99ba57","value":"100%"}},"ebc83bd7d9bf44c4944bd11045ad5e83":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_165453662d4c458d8c6a7f5ffbd87748","max":2,"min":0,"orientation":"horizontal","style":"IPY_MODEL_3b999c7d888b4f98bcd8906ea7c50d19","value":2}},"6f84cbb33d4e48b6acfcd1d9f3da9779":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_cd8ef131538c4d41b95a964ec2d495c4","placeholder":"​","style":"IPY_MODEL_980df4d092ed4f689558bedcbb19290d","value":" 2/2 [00:00&lt;00:00, 54.71it/s]"}},"2ae61d0497354d46b5ad25c79a743f1c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a2976462f9cf423a953c9f1024bb7697":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"63e5da5683e7415fa55a74bebb99ba57":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"165453662d4c458d8c6a7f5ffbd87748":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3b999c7d888b4f98bcd8906ea7c50d19":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"cd8ef131538c4d41b95a964ec2d495c4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"980df4d092ed4f689558bedcbb19290d":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"cells":[{"cell_type":"code","source":["nome = 'Guilherme Pereira'\n","print(f'Meu nome é {nome}')"],"metadata":{"id":"jOdQB41_4ZxG","executionInfo":{"status":"ok","timestamp":1654096967084,"user_tz":180,"elapsed":10,"user":{"displayName":"Guilherme Pereira Albino da Silva","userId":"07971392613373651702"}},"outputId":"22ed265c-c674-43c8-ebc6-5a03005ae494","colab":{"base_uri":"https://localhost:8080/"}},"execution_count":1,"outputs":[{"output_type":"stream","name":"stdout","text":["Meu nome é Guilherme Pereira\n"]}]},{"cell_type":"markdown","metadata":{"id":"2IbuChoAPMEn"},"source":["#  Exercício: Modelo de Linguagem com auto-atenção"]},{"cell_type":"markdown","metadata":{"id":"p_DBb0-Klwf2"},"source":["Este exercício é similar ao da Aula 8, mas iremos agora treinar uma rede neural com **duas camadas** de auto-atenção **causais** para prever a próxima palavra de um texto, data as palavras anteriores como entrada. \n","\n","Iremos também trabalhar com sequencias de tamanho variável.\n","\n","Na camada de auto-atenção, não se esqueça de implementar:\n","- Embeddings de posição\n","- Projeções lineares (WQ, WK, WV, WO)\n","- Conexões residuais\n","- Camada de feed forward (2-layer MLP)\n","\n","\n","O dataset usado neste exercício (BrWaC) possui um tamanho razoável e você vai precisar rodar seus experimentos com GPU.\n","\n","Alguns conselhos úteis:\n","- **ATENÇÃO:** o dataset é bem grande. Não dê comando de imprimí-lo.\n","- Durante a depuração, faça seu dataset ficar bem pequeno, para que a depuração seja mais rápida e não precise de GPU. Somente ligue a GPU quando o seu laço de treinamento já está funcionando\n","- Não deixe para fazer esse exercício na véspera. Ele é trabalhoso."]},{"cell_type":"code","source":["# iremos utilizar a biblioteca dos transformers para ter acesso ao tokenizador do BERT.\n","!pip install transformers"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"3twP0YJC4jmJ","executionInfo":{"status":"ok","timestamp":1654096978347,"user_tz":180,"elapsed":11270,"user":{"displayName":"Guilherme Pereira Albino da Silva","userId":"07971392613373651702"}},"outputId":"5b809263-484d-4b5b-975c-fee8a867d1d1"},"execution_count":2,"outputs":[{"output_type":"stream","name":"stdout","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting transformers\n","  Downloading transformers-4.19.2-py3-none-any.whl (4.2 MB)\n","\u001b[K     |████████████████████████████████| 4.2 MB 36.3 MB/s \n","\u001b[?25hRequirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.7/dist-packages (from transformers) (1.21.6)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.7/dist-packages (from transformers) (3.7.0)\n","Requirement already satisfied: requests in /usr/local/lib/python3.7/dist-packages (from transformers) (2.23.0)\n","Collecting pyyaml>=5.1\n","  Downloading PyYAML-6.0-cp37-cp37m-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl (596 kB)\n","\u001b[K     |████████████████████████████████| 596 kB 54.0 MB/s \n","\u001b[?25hRequirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.7/dist-packages (from transformers) (2019.12.20)\n","Requirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.7/dist-packages (from transformers) (4.64.0)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.7/dist-packages (from transformers) (21.3)\n","Collecting tokenizers!=0.11.3,<0.13,>=0.11.1\n","  Downloading tokenizers-0.12.1-cp37-cp37m-manylinux_2_12_x86_64.manylinux2010_x86_64.whl (6.6 MB)\n","\u001b[K     |████████████████████████████████| 6.6 MB 63.7 MB/s \n","\u001b[?25hRequirement already satisfied: importlib-metadata in /usr/local/lib/python3.7/dist-packages (from transformers) (4.11.3)\n","Collecting huggingface-hub<1.0,>=0.1.0\n","  Downloading huggingface_hub-0.7.0-py3-none-any.whl (86 kB)\n","\u001b[K     |████████████████████████████████| 86 kB 6.8 MB/s \n","\u001b[?25hRequirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.7/dist-packages (from huggingface-hub<1.0,>=0.1.0->transformers) (4.2.0)\n","Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in /usr/local/lib/python3.7/dist-packages (from packaging>=20.0->transformers) (3.0.9)\n","Requirement already satisfied: zipp>=0.5 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata->transformers) (3.8.0)\n","Requirement already satisfied: idna<3,>=2.5 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (2.10)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (2022.5.18.1)\n","Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (1.24.3)\n","Requirement already satisfied: chardet<4,>=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (3.0.4)\n","Installing collected packages: pyyaml, tokenizers, huggingface-hub, transformers\n","  Attempting uninstall: pyyaml\n","    Found existing installation: PyYAML 3.13\n","    Uninstalling PyYAML-3.13:\n","      Successfully uninstalled PyYAML-3.13\n","Successfully installed huggingface-hub-0.7.0 pyyaml-6.0 tokenizers-0.12.1 transformers-4.19.2\n"]}]},{"cell_type":"markdown","metadata":{"id":"YnyhJZtTRNMx"},"source":["## Importação dos pacotes"]},{"cell_type":"code","metadata":{"id":"qlIOVCajPWcU","executionInfo":{"status":"ok","timestamp":1654096980784,"user_tz":180,"elapsed":2458,"user":{"displayName":"Guilherme Pereira Albino da Silva","userId":"07971392613373651702"}}},"source":["import collections\n","import itertools\n","import functools\n","import math\n","import random\n","\n","import torch\n","import torch.nn as nn\n","import numpy as np\n","from torch.utils.data import DataLoader\n","from tqdm import tqdm_notebook\n"],"execution_count":3,"outputs":[]},{"cell_type":"code","source":["# Check which GPU we are using\n","!nvidia-smi"],"metadata":{"id":"w9f3PfifAwpU","executionInfo":{"status":"ok","timestamp":1654096981285,"user_tz":180,"elapsed":519,"user":{"displayName":"Guilherme Pereira Albino da Silva","userId":"07971392613373651702"}},"outputId":"0c271eef-8970-4a89-b863-cf5eaa5bc526","colab":{"base_uri":"https://localhost:8080/"}},"execution_count":4,"outputs":[{"output_type":"stream","name":"stdout","text":["Wed Jun  1 15:23:01 2022       \n","+-----------------------------------------------------------------------------+\n","| NVIDIA-SMI 460.32.03    Driver Version: 460.32.03    CUDA Version: 11.2     |\n","|-------------------------------+----------------------+----------------------+\n","| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n","| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n","|                               |                      |               MIG M. |\n","|===============================+======================+======================|\n","|   0  Tesla T4            Off  | 00000000:00:04.0 Off |                    0 |\n","| N/A   55C    P8    10W /  70W |      0MiB / 15109MiB |      0%      Default |\n","|                               |                      |                  N/A |\n","+-------------------------------+----------------------+----------------------+\n","                                                                               \n","+-----------------------------------------------------------------------------+\n","| Processes:                                                                  |\n","|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |\n","|        ID   ID                                                   Usage      |\n","|=============================================================================|\n","|  No running processes found                                                 |\n","+-----------------------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["if torch.cuda.is_available(): \n","   dev = \"cuda:0\"\n","else: \n","   dev = \"cpu\"\n","device = torch.device(dev)\n","print('Using {}'.format(device))"],"metadata":{"id":"whTCe2i7AtoV","executionInfo":{"status":"ok","timestamp":1654096981286,"user_tz":180,"elapsed":15,"user":{"displayName":"Guilherme Pereira Albino da Silva","userId":"07971392613373651702"}},"outputId":"c5fd05f0-45d7-4e2b-9bf9-105261e38552","colab":{"base_uri":"https://localhost:8080/"}},"execution_count":5,"outputs":[{"output_type":"stream","name":"stdout","text":["Using cuda:0\n"]}]},{"cell_type":"markdown","metadata":{"id":"9ZfxgV2DUk58"},"source":["## Implementação do MyDataset"]},{"cell_type":"code","metadata":{"id":"n_xhKm1EZ3bQ"},"source":["from typing import List\n","\n","\n","def tokenize(text: str, tokenizer):\n","    # Recomenda-se usar o tokenizer.batch_encode_plus pois é mais rápido.\n","    return tokenizer(text, return_tensors=None, add_special_tokens=False).input_ids\n","\n","\n","class MyDataset():\n","    def __init__(self, texts: List[str], tokenizer, max_seq_length: int):\n","        # Escreva aqui seu código.\n","        self.examples = []\n","\n","        for text in tqdm_notebook(texts):\n","            token_ids = tokenize(text=text, tokenizer=tokenizer)\n","\n","            if len(token_ids) < max_seq_length:\n","\n","                pads = max_seq_length - len(token_ids)\n","\n","                input_ids = torch.tensor([101] + token_ids + [0]*(pads-1))\n","                target_id = torch.tensor(token_ids + [0]*pads)\n","\n","                self.examples.append((input_ids, target_id))  \n","\n","            else:   \n","                print((len(token_ids)//max_seq_length))\n","\n","                for i in range((len(token_ids)//max_seq_length) + 1):\n","\n","                    input_ids = torch.tensor([101] + token_ids[i:i+max_seq_length])\n","                    target_id = torch.tensor(token_ids[i:i+max_seq_length+1])\n","\n","                    self.examples.append((input_ids, target_id))  \n","\n","        # print(self.examples)\n","                \n","    def __len__(self):\n","        # Escreva aqui seu código.\n","        return len(self.examples)\n","        \n","\n","    def __getitem__(self, idx):\n","        # Escreva aqui seu código.\n","        return self.examples[idx]"],"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from typing import List\n","\n","\n","def tokenize(text: str, tokenizer):\n","    # Recomenda-se usar o tokenizer.batch_encode_plus pois é mais rápido.\n","    return tokenizer(text, return_tensors=None, add_special_tokens=False).input_ids\n","\n","\n","class MyDataset():\n","    def __init__(self, texts: List[str], tokenizer, max_seq_length: int):\n","        # Escreva aqui seu código.\n","        self.examples = []\n","\n","        for text in tqdm_notebook(texts):\n","\n","            text = text + ' [PAD]'*((max_seq_length-1) + 1 - (len(text.split())% (max_seq_length-1)))\n","            print(text)\n","            token_ids = tokenize(text=text, tokenizer=tokenizer)\n","            # token_ids = token_ids + ' PAD'*(len(token_ids)%(max_seq_length-1) + 1)\n","\n","            \n","            for i in range(len(token_ids)//(max_seq_length-1)+1):\n","\n","                # print(text)\n","\n","                # print(len(token_ids[i*(max_seq_length-1) : (i+1)*(max_seq_length-1)]))\n","\n","                if (len(token_ids[i*(max_seq_length-1) : (i+1)*(max_seq_length-1)]) == max_seq_length-1):\n","\n","                    input_ids = torch.tensor(tokenize(text='[CLS]', tokenizer=tokenizer) + token_ids[i*(max_seq_length-1) : (i+1)*(max_seq_length-1)])\n","                    target_id = torch.tensor(token_ids[i*(max_seq_length-1) : (i+1)*(max_seq_length-1)+1])\n","\n","                    self.examples.append((input_ids, target_id))  \n","\n","        \n","\n","        # print(self.examples)\n","                \n","    def __len__(self):\n","        # Escreva aqui seu código.\n","        return len(self.examples)\n","        \n","\n","    def __getitem__(self, idx):\n","        # Escreva aqui seu código.\n","        return self.examples[idx]"],"metadata":{"id":"K3JEOqzJRTjz"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from typing import List\n","\n","\n","def tokenize(text: str, tokenizer):\n","    # Recomenda-se usar o tokenizer.batch_encode_plus pois é mais rápido.\n","    return tokenizer(text, return_tensors=None, add_special_tokens=False).input_ids\n","\n","\n","class MyDataset():\n","    def __init__(self, texts: List[str], tokenizer, max_seq_length: int):\n","        # Escreva aqui seu código.\n","        self.examples = []\n","\n","        for text in tqdm_notebook(texts):\n","\n","            # text = text + ' [PAD]'*((max_seq_length-1) + 1 - (len(text.split())% (max_seq_length-1)))\n","            # print(text)\n","            token_ids = tokenize(text=text, tokenizer=tokenizer)\n","            # token_ids = token_ids + ' PAD'*(len(token_ids)%(max_seq_length-1) + 1)\n","            itera = len(token_ids)//(max_seq_length-1) if len(token_ids)%(max_seq_length-1) == 0 else len(token_ids)//(max_seq_length-1) + 1\n","            # print(len(token_ids), itera)\n","            \n","            for i in range(itera):\n","\n","                input_ids = torch.tensor([tokenizer.cls_token_id] + token_ids[i*(max_seq_length-1) : (i+1)*(max_seq_length-1)] + [tokenizer.pad_token_id]*max(0, (max_seq_length - 1) - len(token_ids[i*(max_seq_length-1) : (i+1)*(max_seq_length-1)])))\n","                target_id = torch.tensor(token_ids[i*(max_seq_length-1) : (i+1)*(max_seq_length-1)+1] + [tokenizer.pad_token_id]*max(0, (max_seq_length) - len(token_ids[i*(max_seq_length-1) : (i+1)*(max_seq_length-1)+1])))\n","\n","                self.examples.append((input_ids, target_id))  \n","\n","        \n","\n","        # print(self.examples)\n","                \n","    def __len__(self):\n","        # Escreva aqui seu código.\n","        return len(self.examples)\n","        \n","\n","    def __getitem__(self, idx):\n","        # Escreva aqui seu código.\n","        return self.examples[idx]"],"metadata":{"id":"cNGhSre5OqbX"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from typing import List\n","\n","\n","def tokenize(text: str, tokenizer):\n","    # Recomenda-se usar o tokenizer.batch_encode_plus pois é mais rápido.\n","    return tokenizer(text, return_tensors=None, add_special_tokens=False).input_ids\n","\n","\n","\n","\n","class MyDataset():\n","    def __init__(self, texts: List[str], tokenizer, max_seq_length: int):\n","        # Escreva aqui seu código.           \n","\n","\n","    def to_token_ids(text, vocab, max_seq_length, padding_idx):\n","\n","        examples = []\n","\n","        token_ids = tokenize(text=text, tokenizer=tokenizer)\n","        itera = len(token_ids)//(max_seq_length-1) if len(token_ids)%(max_seq_length-1) == 0 else len(token_ids)//(max_seq_length-1) + 1\n","        \n","        for i in range(itera):\n","            input_ids = torch.tensor([tokenizer.cls_token_id] + token_ids[i*(max_seq_length-1) : (i+1)*(max_seq_length-1)] + [tokenizer.pad_token_id]*max(0, (max_seq_length - 1) - len(token_ids[i*(max_seq_length-1) : (i+1)*(max_seq_length-1)])))\n","            target_id = torch.tensor(token_ids[i*(max_seq_length-1) : (i+1)*(max_seq_length-1)+1] + [tokenizer.pad_token_id]*max(0, (max_seq_length) - len(token_ids[i*(max_seq_length-1) : (i+1)*(max_seq_length-1)+1])))\n","\n","            self.examples.append((input_ids, target_id))  \n","\n","                \n","    def __len__(self):\n","        # Escreva aqui seu código.\n","        return len(self.examples)\n","        \n","\n","    def __getitem__(self, idx):\n","        # Escreva aqui seu código.\n","        return self.examples[idx]"],"metadata":{"id":"TiCCWVYraOTV"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from typing import List\n","from tqdm.notebook import tqdm\n","\n","\n","def tokenize(text: str, tokenizer):\n","    # Recomenda-se usar o tokenizer.batch_encode_plus pois é mais rápido.\n","    return tokenizer(text, return_tensors=None, add_special_tokens=False).input_ids\n","\n","\n","class MyDataset():\n","    def __init__(self, texts: List[str], tokenizer, max_seq_length: int):\n","        # Escreva aqui seu código.\n","\n","        # self.ids          = {i: tokenizer(texts, return_tensors=None, add_special_tokens=False).input_ids[i] for i in range(len(texts))} \n","        self.ids          = []\n","        for i in tqdm(range(len(texts))):\n","          # Recomenda-se usar o tokenizer.batch_encode_plus pois é mais rápido.\n","          self.ids.append(tokenizer.batch_encode_plus([text[i]], return_tensors=None, add_special_tokens=False).input_ids)\n","        # self.ids            = tokenizer.batch_encode_plus(texts, return_tensors=None, add_special_tokens=False).input_ids\n","        self.dict_ids       = {}\n","        self.tokenizer      = tokenizer\n","        self.max_seq_length = max_seq_length\n","\n","        total = 0\n","\n","        for i in tqdm(range(len(self.ids))):\n","            itera = len(self.ids[i])//(self.max_seq_length-1) if len(self.ids[i])%(self.max_seq_length-1) == 0 else (len(self.ids[i])//(self.max_seq_length-1))+1\n","            # print(itera)\n","            for j in range(itera):\n","                self.dict_ids[total + j] = [i,j]\n","\n","            total += itera\n","\n","        \n","    def text_to_token(self, idx):\n","\n","        # token_ids = tokenize(text=self.texts[idx], tokenizer=self.tokenizer)\n","\n","        max0 = self.max_seq_length\n","        max1 = self.max_seq_length-1\n","\n","        len_a = len( self.ids[ self.dict_ids[idx][0] ] [self.dict_ids[idx][1]*max1 : (self.dict_ids[idx][1]+1)*max1])\n","        len_b = len( self.ids[ self.dict_ids[idx][0] ] [self.dict_ids[idx][1]*max1 : (self.dict_ids[idx][1]+1)*max0])\n","\n","        limite_a = self.max_seq_length - len_a - 1\n","        limite_b = self.max_seq_length - len_b\n","        # print(limite_a, limite_b)\n","\n","        p_a = self.ids[ self.dict_ids[idx][0] ] [self.dict_ids[idx][1]*max1 : (self.dict_ids[idx][1]+1)*max1]\n","        p_b = self.ids[ self.dict_ids[idx][0] ] [self.dict_ids[idx][1]*max1 : self.dict_ids[idx][1]*max1 + max0]\n","\n","        a = [self.tokenizer.cls_token_id] + p_a + [self.tokenizer.pad_token_id]*max(0, limite_a)\n","        b =  p_b + [self.tokenizer.pad_token_id]*max(0, limite_b)\n","\n","        # print(self.dict_ids[idx])\n","        # print(token_ids)\n","        # print(a)\n","        # print(b)\n","\n","        return (torch.tensor(a), torch.tensor(b))\n","                \n","    def __len__(self):      \n","        return len(self.dict_ids)        \n","\n","    def __getitem__(self, idx):\n","        return self.text_to_token(idx)"],"metadata":{"id":"8rAD28KL3OyD","executionInfo":{"status":"ok","timestamp":1654097387217,"user_tz":180,"elapsed":7,"user":{"displayName":"Guilherme Pereira Albino da Silva","userId":"07971392613373651702"}}},"execution_count":14,"outputs":[]},{"cell_type":"code","source":["# Load datasets\n","%%time\n","max_seq_length = 9\n","\n","train_examples = 80000\n","valid_examples = 20000\n","test_examples  = 20000\n","\n","texts = open('sample-1gb.txt').readlines()\n","\n","print(f'Read {len(texts)} lines.')\n","\n","max_lines = train_examples + valid_examples + test_examples\n","print(f'Truncating to {max_lines} lines.')\n","texts = texts[:max_lines]  \n","\n","\n","training_texts = texts[:-(valid_examples + test_examples)]\n","valid_texts    = texts[-(valid_examples + test_examples):-test_examples]\n","test_texts     = texts[-test_examples:]\n","\n","print('\\nLoadind Training Texts ...')\n","training_dataset = MyDataset(texts=training_texts, tokenizer=tokenizer, max_seq_length=max_seq_length)\n","\n","print('\\nLoadind Validation Texts ...')\n","valid_dataset    = MyDataset(texts=valid_texts, tokenizer=tokenizer, max_seq_length=max_seq_length)\n","\n","print('\\nLoadind Testing Texts ...')\n","test_dataset     = MyDataset(texts=test_texts, tokenizer=tokenizer, max_seq_length=max_seq_length)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":383,"referenced_widgets":["8716f4567f6e432b8880e15f2b1837bb","9a76a4043a944c74b6b7f936f0a95a86","0815d6d4b6064013ae2fce438b25e923","da33629749d4405f8f617a9ae4bf95e9","ebbd026fa1004fadb82df4ee644f5e55","2c7ce3e3726c447a9bce49f65fd63149","ceebfca223334c34b73fdbacaca4b738","d985cd388c0f4ec1aa3042447339323f","e3f660e8b4614738b0212bcde2153865","c9925116555b41f5b280df76b5cd3f4d","fb424a91c74a414eafd82960cf374867","f081061b3ff7456aa3e0224697d851b3","edc61319813d431aa96f662bd4452527","636be7aed451463b9a63bf11b0b5fccf","d1cad6273c304a5ba8015093606a2f36","7dadfd5e2cd6412cac22c1c3783c6a37","9c7e2d9e55c241e4aacbb9e83ffb8b01","7a290a7fef7a478595465b6ab82a5ce1","94dfb33d6e5b4b33bb0e6fabfef99cbe","3c6d38593bae473f96451727200183c5","5b948c7be4be40b2b9c4a779a6ebbd55","a842ff0bb4c7407cbbc2f23ec21417be","26dbf97ce333461396ce99b536601206","dcd51083a535415b97e6ee4965c90a95","a448526b03bf4ed29920ad113cbfbef1","1dae9b9d192a447991a72adbf0aef288","e53ac2d555154ee99451fe5ce66a7f5e","d13c727d0b2046b9be246bac0a610318","d84838b921d8474a8e467413e97cfd02","281ace48e036437d9b9a29e66e6773b1","494d88606b384b388672ed64afe820b6","7cedf8a318d14d5c989aac7e6a8fe43e","02eaaf2dccc14595a942263e987ba532","b2c8a7195fd24b20b778d3708b9fbc33","237117659d0847d7a694f7f029a2964e","ea605fef683c409ba8352b665f002e20","3df9e6b3ba99412996199278078a8de9","5ddc7eebe19b4f08b180795a5fb653a1","0ed7830970d14ee6bf094ccf75b05a3a","5450fe0cb9d645d6be6e29be7bd4d08e","fa4dbbdcbeb64e5ab5a9239ad01ec075","73b51f202cb041d2b45ec2578e524daa","c1bcb33e87a94e6aa7d4946e73614c2e","e85111dda09d4edfad066a3326037bb9","28137371170a49bd9b32ac27f5ff6bd2","dee3f2678078408f8008868c2db693e8","ecfc59ddaaf445b7834561e2b5f51aeb","2fcad1a5abaa415abef77390048fa832","f40acfce117f48d1a906f727bfc4ef6e","717dba7d89564c3d893989c93f49fcb5","dc2a906e30284649937d325d16560422","4f1a41890e5b42beb65b254d9d14794d","4d26dbb71e5e4774bb49f1ce201d52ee","92894d7546304a79b5f5292247d24686","f6665491d2e045eeb74fe835400786d4","4b8260675d654bdd88ccb9fd9492f715","fbd295484c0b4a2682fa30d3e7bd5c7f","f45c7c33bc6b489db7bbc72b83ada377","ddf365c3c129436b836129c2a7175864","71944128ccb84fbe9ffeb1b3d396bb29","44905b79a7f44e43974d4b51b9a49cb5","2859d469daa74101ab1256885a02d26e","1c9e4233bbef48d4b355cf81fcc2f654","09c40e17253446ff9917ac39cd41ba64","f9bc1023f4e0434e9a48e3bf595a2e8c","ded65016c1bf429fa0290bb80edb0ec0"]},"id":"Rjm6n_zV41LW","executionInfo":{"status":"ok","timestamp":1654097515313,"user_tz":180,"elapsed":28761,"user":{"displayName":"Guilherme Pereira Albino da Silva","userId":"07971392613373651702"}},"outputId":"ed928b56-0e95-4e52-a481-5e016981bd2b"},"execution_count":18,"outputs":[{"output_type":"stream","name":"stdout","text":["Read 250000 lines.\n","Truncating to 120000 lines.\n","\n","Loadind Training Texts ...\n"]},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/80000 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"8716f4567f6e432b8880e15f2b1837bb"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/80000 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"f081061b3ff7456aa3e0224697d851b3"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["\n","Loadind Validation Texts ...\n"]},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/20000 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"26dbf97ce333461396ce99b536601206"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/20000 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"b2c8a7195fd24b20b778d3708b9fbc33"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["\n","Loadind Testing Texts ...\n"]},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/20000 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"28137371170a49bd9b32ac27f5ff6bd2"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/20000 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"4b8260675d654bdd88ccb9fd9492f715"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["CPU times: user 27.3 s, sys: 1.19 s, total: 28.4 s\n","Wall time: 28.5 s\n"]}]},{"cell_type":"code","source":["%%time\n","text = ['gosto de comer amendoin']*500_000\n","# Recomenda-se usar o tokenizer.batch_encode_plus pois é mais rápido.\n","tok = tokenizer.batch_encode_plus(text, return_tensors=None, add_special_tokens=False).input_ids"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"E3TcEXRN3jZN","executionInfo":{"status":"ok","timestamp":1654097152376,"user_tz":180,"elapsed":65817,"user":{"displayName":"Guilherme Pereira Albino da Silva","userId":"07971392613373651702"}},"outputId":"5f045857-4be2-4325-a02d-da977b1d7e0f"},"execution_count":11,"outputs":[{"output_type":"stream","name":"stdout","text":["CPU times: user 1min 4s, sys: 312 ms, total: 1min 5s\n","Wall time: 1min 6s\n"]}]},{"cell_type":"code","source":["text = ['gosto de comer amendoin']*500_000\n","exemplo = []\n","for i in tqdm(range(len(text))):\n","    # Recomenda-se usar o tokenizer.batch_encode_plus pois é mais rápido.\n","    exemplo.append(tokenizer.batch_encode_plus([text[i]], return_tensors=\"pt\", add_special_tokens=False).input_ids)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49,"referenced_widgets":["12b314f16e574aed9c2bc27aa6801c57","ef376f01d0ce4a4c999ff41693863256","a3296ab23cac4882b444b7cb64efb69a","41764de7c03f4852bdf129ceecd1b7e8","9b88ed1c3602467a8e0cb3074f9b8daa","06df1a7218914fea8dfac586e489bf4b","ef0362c9812f4ecfa6137478bac53e75","34b82ca831c4402f9b374a5b7003f328","5936d768eccb4d96b7f937f156fa40a9","3b41a80a2b0645acb30d15b90d9234a2","e1d158e7adfe4b0781577e0245f1d877"]},"id":"z1RzEXoa3pGy","executionInfo":{"status":"ok","timestamp":1654097282027,"user_tz":180,"elapsed":119275,"user":{"displayName":"Guilherme Pereira Albino da Silva","userId":"07971392613373651702"}},"outputId":"d4d754f6-e722-403b-fe6a-a8faa2f7ced6"},"execution_count":12,"outputs":[{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/500000 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"12b314f16e574aed9c2bc27aa6801c57"}},"metadata":{}}]},{"cell_type":"code","source":["text = ['gosto de comer amendoin']*500_000\n","exemplo = []\n","for i in tqdm(range(len(text))):\n","    # Recomenda-se usar o tokenizer.batch_encode_plus pois é mais rápido.\n","    exemplo.append(tokenizer.batch_encode_plus([text[i]], return_tensors=None, add_special_tokens=False).input_ids)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49,"referenced_widgets":["fcbde028a7de461c84744d98d7faa304","ec281a7514de49e191059dc1345c090d","e50013af3bf9497692c4a8e3d3c121a9","34c69a43eb57428e83058f1ef1f8b287","66a1d7a106d34594a96c3eed52cf612d","6281b28623744de0af1b053fb5336cc6","8367659b8bc24f27b7147235bbe7390f","d5d36125e822403b8a1a9528cd959f3f","71f717cd6f524160a8003a1fa368fc4e","010d76f0973041088ad186ead797956c","8841838191dc4072999ea04dbd5d1997"]},"id":"qLJmYEPb4KCO","executionInfo":{"status":"ok","timestamp":1654097385900,"user_tz":180,"elapsed":102377,"user":{"displayName":"Guilherme Pereira Albino da Silva","userId":"07971392613373651702"}},"outputId":"c8aca601-5c5e-4cbc-c434-ac7e12ec9027"},"execution_count":13,"outputs":[{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/500000 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"fcbde028a7de461c84744d98d7faa304"}},"metadata":{}}]},{"cell_type":"code","source":["text = ['Eu gosto de correr', 'Ela gosta muito de comer pizza']\n","# Recomenda-se usar o tokenizer.batch_encode_plus pois é mais rápido.\n","tokenizer.batch_encode_plus(text, return_tensors=None, add_special_tokens=False).input_ids"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Tlx7auTV3cDN","executionInfo":{"status":"ok","timestamp":1654097038479,"user_tz":180,"elapsed":486,"user":{"displayName":"Guilherme Pereira Albino da Silva","userId":"07971392613373651702"}},"outputId":"a6ec1d8d-4a58-487e-fa8e-bb782c2bfe78"},"execution_count":8,"outputs":[{"output_type":"execute_result","data":{"text/plain":["[[3396, 10303, 125, 13239], [1660, 5971, 785, 125, 1847, 13779, 15616]]"]},"metadata":{},"execution_count":8}]},{"cell_type":"code","source":["text = ['Eu gosto de correr']\n","# Recomenda-se usar o tokenizer.batch_encode_plus pois é mais rápido.\n","tokenizer.batch_encode_plus(text, return_tensors=None, add_special_tokens=False).input_ids"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"kBoDB1QS3dXA","executionInfo":{"status":"ok","timestamp":1654097050183,"user_tz":180,"elapsed":527,"user":{"displayName":"Guilherme Pereira Albino da Silva","userId":"07971392613373651702"}},"outputId":"8f788668-56a8-4808-8e18-14b818e159b3"},"execution_count":9,"outputs":[{"output_type":"execute_result","data":{"text/plain":["[[3396, 10303, 125, 13239]]"]},"metadata":{},"execution_count":9}]},{"cell_type":"code","source":["text = 'Eu gosto de correr'\n","# Recomenda-se usar o tokenizer.batch_encode_plus pois é mais rápido.\n","tokenizer.batch_encode_plus(text, return_tensors=None, add_special_tokens=False).input_ids"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"HDg1ZBLX3gxx","executionInfo":{"status":"ok","timestamp":1654097061531,"user_tz":180,"elapsed":9,"user":{"displayName":"Guilherme Pereira Albino da Silva","userId":"07971392613373651702"}},"outputId":"dcda879a-46ea-4680-956e-38f359cf3573"},"execution_count":10,"outputs":[{"output_type":"execute_result","data":{"text/plain":["[[192],\n"," [169],\n"," [],\n"," [237],\n"," [146],\n"," [139],\n"," [160],\n"," [146],\n"," [],\n"," [121],\n"," [122],\n"," [],\n"," [127],\n"," [146],\n"," [1335],\n"," [1335],\n"," [122],\n"," [1335]]"]},"metadata":{},"execution_count":10}]},{"cell_type":"code","source":["type(tokenizer.cls_token_id)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"f3rIfRCOQF6B","executionInfo":{"status":"ok","timestamp":1654019626603,"user_tz":180,"elapsed":344,"user":{"displayName":"Guilherme Pereira Albino da Silva","userId":"07971392613373651702"}},"outputId":"654e4bc1-b1f0-4ddf-c7ee-c0b20bae5af9"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["int"]},"metadata":{},"execution_count":13}]},{"cell_type":"code","source":["dummy_texts = ['Eu gosto de correr', 'Ela gosta muito de comer pizza']\n","\n","dummy_dataset = MyDataset(texts=dummy_texts, tokenizer=tokenizer, max_seq_length=3)\n","dummy_loader = DataLoader(dummy_dataset, batch_size=6, shuffle=False)\n","\n","for i in dummy_dataset.examples:\n","    print(i)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":275,"referenced_widgets":["fa5b9ad9107f4495af162ca7d7e63586","df40bc6e66134a15a2ab0e34e77be126","593b2018cb4d4a7f90cecdb149713aaf","e38af0ba41144e0b931cd1c953f892d3","3b41eb3b282b4a9d824bc9233fae5fa4","cb67a69ca3ff4f49bb0b91f312c9a98b","fb544bf051fc4df5931c65bb00b890ef","0ef9272373224752a92f6af2c247e3fe","fcdde59edbaa4005932060ec7d33b03a","0984a3e279df4803a93c03e09cf8fdca","8fb2b502b5774b9ea7984374638e879f"]},"id":"ioqJdYT5e9cg","executionInfo":{"status":"ok","timestamp":1654020048565,"user_tz":180,"elapsed":260,"user":{"displayName":"Guilherme Pereira Albino da Silva","userId":"07971392613373651702"}},"outputId":"c759469f-55ad-40d4-b602-18ea6dbf06e9"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:14: TqdmDeprecationWarning: This function will be removed in tqdm==5.0.0\n","Please use `tqdm.notebook.tqdm` instead of `tqdm.tqdm_notebook`\n","  \n"]},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/2 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"fa5b9ad9107f4495af162ca7d7e63586"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Eu gosto de correr\n","4 2\n","Ela gosta muito de comer pizza\n","7 4\n","(tensor([  101,  3396, 10303]), tensor([ 3396, 10303,   125]))\n","(tensor([  101,   125, 13239]), tensor([  125, 13239,     0]))\n","(tensor([ 101, 1660, 5971]), tensor([1660, 5971,  785]))\n","(tensor([101, 785, 125]), tensor([ 785,  125, 1847]))\n","(tensor([  101,  1847, 13779]), tensor([ 1847, 13779, 15616]))\n","(tensor([  101, 15616,     0]), tensor([15616,     0,     0]))\n"]}]},{"cell_type":"code","source":["   [[  101,  3396, 10303,   125, 13239,     0,     0,     0,     0],\n","     [  101,  1660,  5971,   785,   125,  1847, 13779, 15616,     0]"],"metadata":{"id":"P_8LPLqYRAUl"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["(3-1)-4%(3-1)+1"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"idO8aAMRqSRK","executionInfo":{"status":"ok","timestamp":1653921598726,"user_tz":180,"elapsed":8,"user":{"displayName":"Guilherme Pereira Albino da Silva","userId":"07971392613373651702"}},"outputId":"8fd93bdc-f800-49bd-ff63-d9ee121915c5"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["3"]},"metadata":{},"execution_count":1}]},{"cell_type":"code","source":["tokenizer"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"R2YEeOXFe5Uu","executionInfo":{"status":"ok","timestamp":1653889359513,"user_tz":180,"elapsed":255,"user":{"displayName":"Guilherme Pereira Albino da Silva","userId":"07971392613373651702"}},"outputId":"6fa07d1d-1043-46cb-b82c-1213d7194db7"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["PreTrainedTokenizer(name_or_path='neuralmind/bert-base-portuguese-cased', vocab_size=29794, model_max_len=1000000000000000019884624838656, is_fast=False, padding_side='right', truncation_side='right', special_tokens={'unk_token': '[UNK]', 'sep_token': '[SEP]', 'pad_token': '[PAD]', 'cls_token': '[CLS]', 'mask_token': '[MASK]'})"]},"metadata":{},"execution_count":124}]},{"cell_type":"code","source":["dummy_texts = ['Eu gosto de correr [PAD]']\n","token_ids = tokenize(text=dummy_texts, tokenizer=tokenizer)\n","token_ids"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"OlsninGDfBZc","executionInfo":{"status":"ok","timestamp":1653889536423,"user_tz":180,"elapsed":256,"user":{"displayName":"Guilherme Pereira Albino da Silva","userId":"07971392613373651702"}},"outputId":"55e1d802-a87e-4e07-a65a-e7f876f33562"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["[[3396, 10303, 125, 13239, 0]]"]},"metadata":{},"execution_count":135}]},{"cell_type":"markdown","source":["## Testando se a implementação do MyDataset está correta"],"metadata":{"id":"wew-gFbWeBTq"}},{"cell_type":"code","source":["from transformers import BertTokenizer\n","\n","tokenizer = BertTokenizer.from_pretrained(\"neuralmind/bert-base-portuguese-cased\")\n","\n","dummy_texts = ['Eu gosto de correr', 'Ela gosta muito de comer pizza']\n","\n","dummy_dataset = MyDataset(texts=dummy_texts, tokenizer=tokenizer, max_seq_length=9)\n","dummy_loader = DataLoader(dummy_dataset, batch_size=6, shuffle=False)\n","assert len(dummy_dataset) == 2\n","print('Passou no assert de tamanho do dataset.')\n","\n","first_batch_input, first_batch_target = next(iter(dummy_loader))\n","\n","correct_first_batch_input = torch.LongTensor(\n","    [[  101,  3396, 10303,   125, 13239,     0,     0,     0,     0],\n","     [  101,  1660,  5971,   785,   125,  1847, 13779, 15616,     0]])\n","\n","correct_first_batch_target = torch.LongTensor(\n","    [[ 3396, 10303,   125, 13239,     0,     0,     0,     0,     0],\n","     [ 1660,  5971,   785,   125,  1847, 13779, 15616,     0,     0]])\n","\n","assert torch.equal(first_batch_input, correct_first_batch_input)\n","assert torch.equal(first_batch_target, correct_first_batch_target)\n","\n","print('Passou no assert de dataset.')"],"metadata":{"id":"8r7jBFFUeApe","executionInfo":{"status":"ok","timestamp":1654097021248,"user_tz":180,"elapsed":13282,"user":{"displayName":"Guilherme Pereira Albino da Silva","userId":"07971392613373651702"}},"outputId":"943ff0a2-e53a-4ac4-d7a5-44540b2218e9","colab":{"base_uri":"https://localhost:8080/","height":244,"referenced_widgets":["81344ee736f14ecb91d36bc9d40c9f94","eeed1d6e1979427d966c50c99f554709","5df7a2401266439480c6e1c49c30d9f9","9a7fb12fd79b43ba8b259a5b3c7b929b","8aaa37edc0ff4a50b7a05e445475f9c4","3a04f6e27b6d418698d3def01d1333f6","824086478d6a4de395c2f44354972235","e9a8937c80994c018cc583ffa90abb39","361898c037214344a0e16599b994a9f7","580c3eb7b2ce49b0a2725a84113a1499","52994510c24c4b37b6e1ae93cffebd36","5fcd502bcd224abd8d55c2f4b9d407fc","d82165ba79af4e989ff93fbfc3909d31","4bded2a295f44dd28b77f4208e8c4c04","d243f79a52204c3b8b45063e67bcd3e1","9a65c7d50e764f199cd998b12f404197","c357376ac4cc4ae08a0904ba899a9420","5505b8ed41ee40068065895a5b05fcf3","38f4ca1c8cec4265a08b15cbb0752a37","62b009774fc74ec1af3814fce6507861","ee6e285a31d1457b98c61e06548408c8","4c8579cf02b045858897afeba72b7b0c","0c6f97ef59ab428fa87eb778b22a157d","e06b0d9e2f3e443d995aef00e3c72135","af310706b36a4d42b63caa833a08b929","6ea1cff10b794d4aa27627d5de2c3abe","218cec81a229474e9cf6f0147d716684","689c6dfcee9d4872a1f84e3b8f4c2705","c59d7230dc8b4364a5f57c975962a434","abd069aaf6ad44b7b388124e960e5253","52a43f7ff4034f368d56dbd4706679a4","3d5f1a14363b4a89ad52158a775d8c3f","5bdb0c9dd2884041a0b7fc4e81665eb0","f15add4af0cf4a849e50d670d12335a0","dcc87114eea043aebbaa5fe55b0e441e","863bb20541ff41758b052314782715a0","3a591c7465bb423aac0c99a10cc2442a","353e72192b5b482eaa0a6d43cd1e5fb1","7bcdd789f5c14e9abbc4ee09eaf71d1a","03c1e6da37c54c99b3e892aa48ac5cac","38f3910038484ce088b32840af2a0662","f65540f5614b4822a8aa4b11ab96045f","eb2d858642d94bdfaa664d95218c7f34","963d0aac754b4cbdb88d636b0ffbe248","43207aa140874f3babe22ccb505bed8b","2a8fabd22e7a421e8664aab3462d1edb","4f93e4f0b4114668b72bf0a7455ec623","ab281334493c4709b95fb441c4c714e8","f8d5ae79738a4733b2be8608b5ac8dc9","05d0f483cbf84ee181009079ebe07976","f9f7e63559c942fb8bf85f93ad35d53a","6fe6f20e63584b7cb2022f0c054b2fc9","21b535e52b1f48298fc08e758cee8cde","a053d204092b4a249b56da3d56bc6dd1","f034e2d5ac1f4cb899d8bec905389cb6","3781f0730c644b678fd8c170f0c81850","672f5486ed844fc383c531526bd2ca22","ebc83bd7d9bf44c4944bd11045ad5e83","6f84cbb33d4e48b6acfcd1d9f3da9779","2ae61d0497354d46b5ad25c79a743f1c","a2976462f9cf423a953c9f1024bb7697","63e5da5683e7415fa55a74bebb99ba57","165453662d4c458d8c6a7f5ffbd87748","3b999c7d888b4f98bcd8906ea7c50d19","cd8ef131538c4d41b95a964ec2d495c4","980df4d092ed4f689558bedcbb19290d"]}},"execution_count":7,"outputs":[{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/205k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"81344ee736f14ecb91d36bc9d40c9f94"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/2.00 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"5fcd502bcd224abd8d55c2f4b9d407fc"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/112 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"0c6f97ef59ab428fa87eb778b22a157d"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/43.0 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"f15add4af0cf4a849e50d670d12335a0"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/647 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"43207aa140874f3babe22ccb505bed8b"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/2 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"3781f0730c644b678fd8c170f0c81850"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Passou no assert de tamanho do dataset.\n","Passou no assert de dataset.\n"]}]},{"cell_type":"markdown","metadata":{"id":"4LfrHHouleJ0"},"source":["# Carregamento do dataset "]},{"cell_type":"markdown","metadata":{"id":"V2vFWjsSkmop"},"source":["Iremos usar uma pequena amostra do dataset [BrWaC](https://www.inf.ufrgs.br/pln/wiki/index.php?title=BrWaC) para treinar e avaliar nosso modelo de linguagem."]},{"cell_type":"code","source":["!wget -nc https://storage.googleapis.com/unicamp-dl/ia025a_2022s1/aula9/sample-1gb.txt"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"vGlN1WqrXPA6","executionInfo":{"status":"ok","timestamp":1654097421025,"user_tz":180,"elapsed":6750,"user":{"displayName":"Guilherme Pereira Albino da Silva","userId":"07971392613373651702"}},"outputId":"c9c62ac4-6793-490c-db57-0e0bdf63cb26"},"execution_count":16,"outputs":[{"output_type":"stream","name":"stdout","text":["--2022-06-01 15:30:14--  https://storage.googleapis.com/unicamp-dl/ia025a_2022s1/aula9/sample-1gb.txt\n","Resolving storage.googleapis.com (storage.googleapis.com)... 142.250.4.128, 74.125.200.128, 74.125.68.128, ...\n","Connecting to storage.googleapis.com (storage.googleapis.com)|142.250.4.128|:443... connected.\n","HTTP request sent, awaiting response... 200 OK\n","Length: 1230909256 (1.1G) [text/plain]\n","Saving to: ‘sample-1gb.txt’\n","\n","sample-1gb.txt      100%[===================>]   1.15G   225MB/s    in 5.9s    \n","\n","2022-06-01 15:30:20 (199 MB/s) - ‘sample-1gb.txt’ saved [1230909256/1230909256]\n","\n"]}]},{"cell_type":"code","source":["# Load datasets\n","max_seq_length = 9\n","\n","train_examples = 500\n","valid_examples = 100\n","test_examples = 100\n","\n","texts = open('sample-1gb.txt').readlines()\n","\n","print(f'Read {len(texts)} lines.')\n","\n","max_lines = train_examples + valid_examples + test_examples\n","print(f'Truncating to {max_lines} lines.')\n","texts = texts[:max_lines]  \n","\n","training_texts = texts[:-(valid_examples + test_examples)]\n","valid_texts = texts[-(valid_examples + test_examples):-test_examples]\n","test_texts = texts[-test_examples:]\n","\n","training_dataset = MyDataset(texts=training_texts, tokenizer=tokenizer, max_seq_length=max_seq_length)\n","valid_dataset = MyDataset(texts=valid_texts, tokenizer=tokenizer, max_seq_length=max_seq_length)\n","test_dataset = MyDataset(texts=test_texts, tokenizer=tokenizer, max_seq_length=max_seq_length)"],"metadata":{"id":"gxa_4gmiA-wE","colab":{"base_uri":"https://localhost:8080/","height":269},"executionInfo":{"status":"error","timestamp":1654037984634,"user_tz":180,"elapsed":6855,"user":{"displayName":"Guilherme Pereira Albino da Silva","userId":"07971392613373651702"}},"outputId":"8d8d6d3a-43c1-40db-b4f6-5e233ed854e6"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Read 250000 lines.\n","Truncating to 700 lines.\n"]},{"output_type":"error","ename":"NameError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)","\u001b[0;32m<ipython-input-1-6e73baebd49e>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[1;32m     18\u001b[0m \u001b[0mtest_texts\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mtexts\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m-\u001b[0m\u001b[0mtest_examples\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     19\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 20\u001b[0;31m \u001b[0mtraining_dataset\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mMyDataset\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtexts\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mtraining_texts\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mtokenizer\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mtokenizer\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mmax_seq_length\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mmax_seq_length\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     21\u001b[0m \u001b[0mvalid_dataset\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mMyDataset\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtexts\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mvalid_texts\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mtokenizer\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mtokenizer\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mmax_seq_length\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mmax_seq_length\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     22\u001b[0m \u001b[0mtest_dataset\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mMyDataset\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtexts\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mtest_texts\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mtokenizer\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mtokenizer\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mmax_seq_length\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mmax_seq_length\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mNameError\u001b[0m: name 'MyDataset' is not defined"]}]},{"cell_type":"code","source":["print(f'training examples: {len(training_dataset)}')\n","print(f'valid examples: {len(valid_dataset)}')\n","print(f'test examples: {len(test_dataset)}')"],"metadata":{"id":"KCSGJ5m7py4c","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1654033571779,"user_tz":180,"elapsed":16,"user":{"displayName":"Guilherme Pereira Albino da Silva","userId":"07971392613373651702"}},"outputId":"d0f89855-4e1c-40cf-b817-29dc30836fe2"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["training examples: 85667\n","valid examples: 11390\n","test examples: 10759\n"]}]},{"cell_type":"code","source":[""],"metadata":{"id":"wgkds0TmEBgf"},"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"hGaAjYDfWdd1"},"source":["class LanguageModel(torch.nn.Module):\n","\n","    def __init__(self, vocab_size: int, max_seq_length: int, dim: int, n_layers: int, pad_token_id: int):\n","        \"\"\"\n","        Implements the Self-attention, decoder-only.\"\n","\n","        Args:\n","            vocab_size (int): Size of the input vocabulary.\n","            max_seq_length (int): Size of the sequence to consider as context for prediction.\n","            dim (int): Dimension of the embedding layer for each word in the context.\n","            n_layers (int): number of self-attention layers.\n","            pad_token_id (int): id of the pad token that will be ignored in the attention.\n","        \"\"\"\n","        # Escreva seu código aqui.\n","\n","        super().__init__()\n","\n","        self.vocab_size     = vocab_size\n","        self.max_seq_length = max_seq_length\n","        self.dim            = dim\n","        self.n_layers       = n_layers\n","        self.pad_token_id   = pad_token_id\n","        \n","\n","        self.embedding_layer       = torch.nn.Embedding(self.vocab_size, self.dim)\n","        self.positional_embeddings = torch.nn.Linear(self.dim, self.max_seq_length, bias=False)\n","\n","        self.W_q = torch.nn.Linear(self.dim,self.dim,bias=False) # D, H * D/H\n","        self.W_k = torch.nn.Linear(self.dim,self.dim,bias=False) # D, H * D/H\n","        self.W_v = torch.nn.Linear(self.dim,self.dim,bias=False) # D, H * D/H\n","        self.W_o = torch.nn.Linear(self.dim,self.dim,bias=False) # D, H * D/H\n","        \n","        self.layer_norm1  = torch.nn.LayerNorm(self.dim,eps=1e-6) # (create with eps=1e-6)\n","\n","        hidden_size = 2*self.dim\n","        self.feed_forward = torch.nn.Sequential(nn.Linear(self.max_seq_length*self.dim, hidden_size),\n","                                                torch.nn.ReLU(),\n","                                                nn.Linear(hidden_size,self.max_seq_length*vocab_size))# (2 layers with a ReLU in-between) \n","\n","\n","    \n","    def attention(self, Q, K, V, inputs):        \n","        \n","        scores = torch.matmul(Q, K.transpose(-1, -2))\n","        mask   = inputs != self.pad_token_id\n","        \n","        mask_expanded = mask[:, None, :].expand_as(scores)\n","        scores.masked_fill_(~mask_expanded, float('-inf'))\n","        probs = F.softmax(scores, dim=-1)\n","        \n","        return torch.matmul(probs, V)\n","\n","\n","    def forward(self, inputs):\n","        \"\"\"\n","        Args:\n","            inputs is a LongTensor of shape (batch_size, max_seq_length)\n","            \n","        Returns:\n","            logits of shape (batch_size, vocab_size)\n","        \"\"\"\n","        # Escreva seu código aqui.\n","\n","        self.B = inputs.shape[0]\n","        self.C = self.embedding_layer(inputs)\n","        X = self.C + self.positional_embeddings.weight\n","\n","        for i in range(self.n_layers):\n","        \n","            q = self.W_q(X)\n","            k = self.W_k(X)\n","            v = self.W_v(X)\n","\n","            new_x  = self.attention(q, k, v, inputs)\n","            X      = self.W_o(new_x)\n","\n","        logits = self.feed_forward(X.reshape(len(inputs),-1))\n","\n","        logits = logits.reshape(X.shape[0],self.max_seq_length,self.vocab_size)\n","        \n","        return logits\n","    \n","    "],"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["## Teste o modelo com um exemplo"],"metadata":{"id":"Rm6_PTH2i98e"}},{"cell_type":"code","metadata":{"id":"RwnxfZlrZoT_"},"source":["model = LanguageModel(\n","    vocab_size=tokenizer.vocab_size,\n","    max_seq_length=max_seq_length,\n","    dim=64,\n","    n_layers=2,\n","    pad_token_id=tokenizer.pad_token_id,\n",").to(device)\n","\n","sample_input, _ = next(iter(DataLoader(training_dataset)))\n","sample_input = sample_input.to(device)\n","sample_output = model(sample_input)\n","print(f'sample_input.shape: {sample_input.shape}')\n","print(f'sample_output.shape: {sample_output.shape}')"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"I3Vh6B-VkA01","executionInfo":{"status":"ok","timestamp":1654036892137,"user_tz":180,"elapsed":831,"user":{"displayName":"Guilherme Pereira Albino da Silva","userId":"07971392613373651702"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"f46b8ab3-a9b5-479b-b693-e6edf97e7330"},"source":["num_params = sum(p.numel() for p in model.parameters() if p.requires_grad)\n","print(f'Number of model parameters: {num_params}')"],"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Number of model parameters: 36588594\n"]}]},{"cell_type":"markdown","source":["## Assert da Perplexidade\n"],"metadata":{"id":"8nhbUVsYnVAp"}},{"cell_type":"code","source":["random.seed(123)\n","np.random.seed(123)\n","torch.manual_seed(123)\n","\n","\n","def perplexity(logits, target, ignore_token_id: int):\n","    \"\"\"\n","    Computes the perplexity.\n","\n","    Args:\n","        logits: a FloatTensor of shape (batch_size, seq_len, vocab_size)\n","        target: a LongTensor of shape (batch_size, seq_len)\n","\n","    Returns:\n","        A float corresponding to the perplexity\n","    \"\"\"\n","    logits = logits.reshape(-1, logits.shape[-1])\n","    target = target.reshape(-1)\n","    loss = nn.functional.cross_entropy(logits, target, reduction='mean', ignore_index=ignore_token_id)\n","    return torch.exp(loss)\n","\n","\n","n_examples = 1000\n","\n","train_input_ids, train_target_ids = next(iter(DataLoader(training_dataset, batch_size=n_examples)))\n","train_input_ids = train_input_ids.to(device)\n","train_target_ids = train_target_ids.to(device)\n","\n","logits = model(train_input_ids)\n","\n","my_perplexity = perplexity(logits=logits, target=train_target_ids, ignore_token_id=tokenizer.pad_token_id)\n","\n","print(f'my perplexity:              {int(my_perplexity)}')\n","print(f'correct initial perplexity: {tokenizer.vocab_size}')\n","\n","assert math.isclose(my_perplexity, tokenizer.vocab_size, abs_tol=7000)\n","print('Passou o no assert da perplexidade')"],"metadata":{"id":"gbMP8VAUncfX","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1654036894701,"user_tz":180,"elapsed":254,"user":{"displayName":"Guilherme Pereira Albino da Silva","userId":"07971392613373651702"}},"outputId":"24be2fcf-73a9-4ea6-e021-5a40077d07ab"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["my perplexity:              29815\n","correct initial perplexity: 29794\n","Passou o no assert da perplexidade\n"]}]},{"cell_type":"markdown","source":["## Laço de Treinamento e Validação"],"metadata":{"id":"KiJtrsqPnE_l"}},{"cell_type":"code","metadata":{"id":"zIMSaY-UUGUE"},"source":["max_examples = 150_000_000\n","eval_every_steps = 10000\n","lr = 3e-4\n","\n","\n","model = LanguageModel(\n","    vocab_size=tokenizer.vocab_size,\n","    max_seq_length=max_seq_length,\n","    dim=64,\n","    n_layers=2,\n","    pad_token_id=tokenizer.pad_token_id,\n",").to(device)\n","\n","train_loader = DataLoader(training_dataset, batch_size=64, shuffle=True, drop_last=True)\n","validation_loader = DataLoader(valid_dataset, batch_size=64)\n","\n","optimizer = torch.optim.Adam(model.parameters(), lr=lr)\n","\n","\n","def train_step(input_ids, target_ids):\n","    model.train()\n","    model.zero_grad()\n","    logits = model(input_ids)\n","    logits = logits.reshape(-1, logits.shape[-1])\n","    target_ids = target_ids.reshape(-1)\n","    loss = nn.functional.cross_entropy(logits, target_ids, ignore_index=model.pad_token_id)\n","    loss.backward()\n","    optimizer.step()\n","\n","    return loss.item()\n","\n","\n","def validation_step(input_ids, target_ids):\n","    model.eval()\n","    logits = model(input_ids)\n","    logits = logits.reshape(-1, logits.shape[-1])\n","    target_ids = target_ids.reshape(-1)\n","    loss = nn.functional.cross_entropy(logits, target_ids, ignore_index=model.pad_token_id)\n","    return loss.item()\n","\n","\n","train_losses = []\n","n_examples = 0\n","step = 0\n","while n_examples < max_examples:\n","    for train_input_ids, train_target_ids in train_loader:\n","        loss = train_step(train_input_ids.to(device), train_target_ids.to(device)) \n","        train_losses.append(loss)\n","        \n","        if step % eval_every_steps == 0:\n","            train_ppl = np.exp(np.average(train_losses))\n","\n","            with torch.no_grad():\n","                valid_ppl = np.exp(np.average([\n","                    validation_step(val_input_ids.to(device), val_target_ids.to(device))\n","                    for val_input_ids, val_target_ids in validation_loader]))\n","\n","            print(f'{step} steps; {n_examples} examples so far; train ppl: {train_ppl:.2f}, valid ppl: {valid_ppl:.2f}')\n","            train_losses = []\n","\n","        n_examples += len(train_input_ids)  # Increment of batch size\n","        step += 1\n","        if n_examples >= max_examples:\n","            break"],"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["## Avaliação final no dataset de teste\n","\n","\n","Bonus: o modelo com menor perplexidade no dataset de testes ganhará 0.5 ponto na nota final."],"metadata":{"id":"VgdNymJdNPXP"}},{"cell_type":"code","metadata":{"id":"nxN5YytzZ7Tn"},"source":["test_loader = DataLoader(test_dataset, batch_size=64)\n","\n","with torch.no_grad():\n","    test_ppl = np.exp(np.average([\n","        validation_step(test_input_ids.to(device), test_target_ids.to(device))\n","        for test_input_ids, test_target_ids in test_loader\n","    ]))\n","\n","print(f'test perplexity: {test_ppl}')"],"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["## Teste seu modelo com uma sentença\n","\n","Escolha uma sentença gerada pelo modelo que ache interessante."],"metadata":{"id":"BHvEs8mPszy_"}},{"cell_type":"code","source":["prompt = 'Eu gosto de comer pizza pois me faz'\n","max_output_tokens = 20\n","model.eval()\n","\n","for _ in range(max_output_tokens):\n","    input_ids = tokenize(text=prompt, tokenizer=tokenizer)\n","    input_ids_truncated = input_ids[-max_seq_length:]  # Usamos apenas os últimos <max_seq_length> tokens como entrada para o modelo.\n","    logits = model(torch.LongTensor([input_ids_truncated]).to(device))\n","    logits = logits[:, -1, :]  # Usamos apenas o ultimo token da sequencia\n","    # Ao usarmos o argmax, a saída do modelo em cada passo é o token de maior probabilidade.\n","    # Isso se chama decodificação gulosa (greedy decoding).\n","    predicted_id = torch.argmax(logits).item()\n","    input_ids += [predicted_id]  # Concatenamos a entrada com o token escolhido nesse passo.\n","    prompt = tokenizer.decode(input_ids)\n","    print(prompt)"],"metadata":{"id":"-CFElf4tsytW"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["## Bonus 1\n","Quem conseguir a menor perplexidade no dataset de testes ganha 0.5 ponto na média final.\n","\n","## Bonus 2\n","Qual é a complexidade (em notação O-grande) da função de geração de texto acima?\n","\n","Quem responder corretamente a pergunta acima e deixar a função com menor complexidade ganha 0.5 ponto na média final."],"metadata":{"id":"nGdxlXhGq7Ua"}}]}